<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="robots" content="noindex">
  <title>Tính lương</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <style type="text/css">
  form label {
    font-size: 12px;
  }
  .btn, .form-control { border-radius: 0; }
  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
</head>
<body>

<form>
  <div class="container">
    <div class="row">
      <div class="col-md-6">

        <h3>Thu nhập</h3>
        <div class="row">
          <div class="col-md-4">
            <div class="form-group">
              <label for="vnd">VNĐ</label>
              <input type="text" class="form-control" id="vnd" value="10,000,000" maxlength="12">
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="usd">USD</label>
              <input type="text" class="form-control" id="usd" value="0.0" maxlength="11">
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="RATIO">Tỉ giá</label>
              <input type="text" class="form-control" id="RATIO" value="22,300" maxlength="12">
              <p class="help-block">1USD = ... VNĐ</p>
            </div>
          </div>
        </div>
        <h3>Bảo hiểm</h3>
        <div class="row">
          <div class="col-md-3">
            <div class="form-group">
              <label for="MIN_SALARY">Lương tối thiểu</label>
              <input type="text" class="form-control" id="MIN_SALARY" value="1,150,000" maxlength="12">
              <p class="help-block">VNĐ</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="social">Xã hội</label>
              <input type="text" class="form-control" id="social" value="8.0" maxlength="5">
              <p class="help-block">%</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="health">Y tế</label>
              <input type="text" class="form-control" id="health" value="1.5" maxlength="5">
              <p class="help-block">%</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="unem">Thất nghiệp</label>
              <input type="text" class="form-control" id="unem" value="1.0" maxlength="5">
              <p class="help-block">%</p>
            </div>
          </div>
        </div>
        <h3>Giảm trừ gia cảnh</h3>
        <div class="row">
          <div class="col-md-4">
            <div class="form-group">
              <label for="PERSONAL_REDUCE">Cá nhân</label>
              <input type="text" class="form-control" id="PERSONAL_REDUCE" value="9,000,000" maxlength="12">
              <p class="help-block">VNĐ</p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="DEPENDANT_REDUCE">Phụ thuộc</label>
              <input type="text" class="form-control" id="DEPENDANT_REDUCE" value="3,600,000" maxlength="12">
              <p class="help-block">VNĐ</p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="depNum">Số người phụ thuộc</label>
              <input type="text" class="form-control" id="depNum" value="0" maxlength="2">
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-6"><button id="btn1" type="button" class="btn btn-primary btn-lg btn-block">GROSS -> NET</button></div>
          <div class="col-md-6"><button id="btn2" type="button" class="btn btn-primary btn-lg btn-block">NET -> GROSS</button></div>
        </div>
      </div>
      <div class="col-md-6" id="result"></div>
    </div>
  </div>
</form>
<script id="tpl" type="text/template">
  <h3>Diễn giải chi tiết (VND)</h3>
  <table class="table table-hover">
    <tbody>
      <tr>
        <th class="text-right">Lương GROSS</th>
        <th class="text-right">{{_.grossSalary|number_format}}</th>
      </tr>
      <tr>
        <td class="text-right">Bảo hiểm xã hội ({{_.SOCIAL}}%)</td>
        <td class="text-right">- {{_.socialInsurance|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right">Bảo hiểm y tế ({{_.HEALTH}}%)</td>
        <td class="text-right">- {{_.healthInsurance|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right">Bảo hiểm thất nghiệp ({{_.UNEMPLOY}}%)</td>
        <td class="text-right">- {{_.unemployInsurance|number_format}}</td>
      </tr>
      <tr>
        <th class="text-right">Thu nhập trước thuế</th>
        <th class="text-right">- {{_.noTaxSalary|number_format}}</th>
      </tr>
      <tr>
        <td class="text-right">Giảm trừ gia cảnh bản thân</td>
        <td class="text-right">- {{_.PERSONAL_REDUCE|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right">Giảm trừ gia cảnh người phụ thuộc</td>
        <td class="text-right">- {{_.dependantReduce|number_format}}</td>
      </tr>
      <tr>
        <th class="text-right">Thu nhập chịu thuế</th>
        <th class="text-right">- {{_.taxSalary|number_format}}</th>
      </tr>
      <tr>
        <th class="text-right">Thuế thu nhập cá nhân (*)</th>
        <th class="text-right">- {{_.totalTax|number_format}}</th>
      </tr>
      <tr>
        <td class="text-right"><strong>Lương NET</strong><br><small>(Thu nhập trước thuế - Thuế thu nhập cá nhân)</small></td>
        <th class="text-right">{{_.netSalary|number_format}}</th>
      </tr>
    </tbody>
  </table>
  <h3>Chi tiết thuế thu nhập cá nhân (VND)</h3>
  <table class="table table-hover">
    <thead>
      <tr>
        <th class="text-right">Mức chịu thuế</th>
        <th class="text-right">Thuế suất</th>
        <th class="text-right">Tiền nộp</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="text-right">Đến 5 triệu VND</td>
        <td class="text-right">5%</td>
        <td class="text-right">{{_.tax1|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right">Trên 5 triệu VND đến 10 triệu VND</td>
        <td class="text-right">10%</td>
        <td class="text-right">{{_.tax2|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right">Trên 10 triệu VND đến 18 triệu VND</td>
        <td class="text-right">15%</td>
        <td class="text-right">{{_.tax3|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right">Trên 18 triệu VND đến 32 triệu VND</td>
        <td class="text-right">20%</td>
        <td class="text-right">{{_.tax4|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right">Trên 32 triệu VND đến 52 triệu VND</td>
        <td class="text-right">25%</td>
        <td class="text-right">{{_.tax5|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right">Trên 52 triệu VND đến 80 triệu VND</td>
        <td class="text-right">30%</td>
        <td class="text-right">{{_.tax6|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right">Trên 80 triệu VND</td>
        <td class="text-right">35%</td>
        <td class="text-right">{{_.tax7|number_format}}</td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <th class="text-right">Tổng thuế</th>
        <th class="text-right" colspan="2">{{_.totalTax|number_format}}</th>
      </tr>
    </tfoot>
  </table>
  <h3>Người lao động trả (VND)</h3>
  <table class="table table-hover">
    <tbody>
      <tr>
        <th class="text-right" class="text-right">Lương GROSS</th>
        <th class="text-right">{{_.grossSalary|number_format}}</th>
      </tr>
      <tr>
        <td class="text-right" class="text-right">Bảo hiểm xã hội({{_.EMPLOYER_SOCIAL}}%)</td>
        <td class="text-right">{{_.employerSocialInsurance|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right" class="text-right">Bảo hiểm y tế({{_.EMPLOYER_HEALTH}}%)</td>
        <td class="text-right">{{_.employerHealthInsurance|number_format}}</td>
      </tr>
      <tr>
        <td class="text-right" class="text-right">Bảo hiểm thất nghiệp({{_.EMPLOYER_UNEMPLOY}}%)</td>
        <td class="text-right">{{_.employerUnemployInsurance|number_format}}</td>
      </tr>
      <tr>
        <th class="text-right" class="text-right">Tổng cộng</th>
        <th class="text-right">{{_.employerTotal|number_format}}</th>
      </tr>
    </tbody>
  </table>
</script>
<script type="text/javascript">
  /*
    Markup.js v1.5.21: http://github.com/adammark/Markup.js
  */
  var Mark={includes:{},globals:{},delimiter:">",compact:false,_copy:function(d,c){c=c||[];for(var e in d){c[e]=d[e]}return c},_size:function(b){return b instanceof Array?b.length:(b||0)},_iter:function(a,b){this.idx=a;this.size=b;this.length=b;this.sign="#";this.toString=function(){return this.idx+this.sign.length-1}},_pipe:function(h,c){var g,f,b,a;if((g=c.shift())){f=g.split(this.delimiter);b=f.shift().trim();try{a=Mark.pipes[b].apply(null,[h].concat(f));h=this._pipe(a,c)}catch(d){}}return h},_eval:function(e,g,h){var a=this._pipe(e,g),b=a,d=-1,c,f;if(a instanceof Array){a="";c=b.length;while(++d<c){f={iter:new this._iter(d,c)};a+=h?Mark.up(h,b[d],f):b[d]}}else{if(a instanceof Object){a=Mark.up(h,b)}}return a},_test:function(a,e,c,b){var d=Mark.up(e,c,b).split(/\{\{\s*else\s*\}\}/);return(a===false?d[1]:d[0])||""},_bridge:function(h,e){e=e=="."?"\\.":e.replace(/\$/g,"\\$");var f="{{\\s*"+e+"([^/}]+\\w*)?}}|{{/"+e+"\\s*}}",n=new RegExp(f,"g"),p=h.match(n)||[],o,g,m=0,l=0,k=-1,j=0;for(g=0;g<p.length;g++){o=g;k=h.indexOf(p[o],k+1);if(p[o].indexOf("{{/")>-1){l++}else{m++}if(m===l){break}}m=h.indexOf(p[0]);l=m+p[0].length;j=k+p[o].length;return[h.substring(m,j),h.substring(l,k)]}};Mark.up=function(s,b,e){b=b||{};e=e||{};var m=/\{\{(.+?)\}\}/g,l=s.match(m)||[],t,d,g,h=[],r,c,f,k,o,a,n,q=0,p=0;if(e.pipes){this._copy(e.pipes,this.pipes)}if(e.includes){this._copy(e.includes,this.includes)}if(e.globals){this._copy(e.globals,this.globals)}if(e.delimiter){this.delimiter=e.delimiter}if(e.compact!==undefined){this.compact=e.compact}while((t=l[q++])){k=undefined;f="";r=t.indexOf("/}}")>-1;d=t.substr(2,t.length-(r?5:4));d=d.replace(/`(.+?)`/g,function(i,j){return Mark.up("{{"+j+"}}",b)});c=d.trim().indexOf("if ")===0;h=d.split("|");h.shift();d=d.replace(/^\s*if/,"").split("|").shift().trim();g=c?"if":d.split("|")[0];n=b[d];if(c&&!h.length){h=["notempty"]}if(!r&&s.indexOf("{{/"+g)>-1){k=this._bridge(s,g);t=k[0];f=k[1];q+=t.match(m).length-1}if(/^\{\{\s*else\s*\}\}$/.test(t)){continue}else{if((o=this.globals[d])!==undefined){k=this._eval(o,h,f)}else{if((a=this.includes[d])){if(a instanceof Function){a=a()}k=this._pipe(Mark.up(a,b,e),h)}else{if(d.indexOf("#")>-1){e.iter.sign=d;k=this._pipe(e.iter,h)}else{if(d==="."){k=this._pipe(b,h)}else{if(d.indexOf(".")>-1){d=d.split(".");n=Mark.globals[d[0]];if(n){p=1}else{p=0;n=b}while(n&&p<d.length){n=n[d[p++]]}k=this._eval(n,h,f)}else{if(c){k=this._pipe(n,h)}else{if(n instanceof Array){k=this._eval(n,h,f)}else{if(f){k=n?Mark.up(f,n):undefined}else{if(b.hasOwnProperty(d)){k=this._pipe(n,h)}}}}}}}}}}if(k instanceof Array){k=this._eval(k,h,f)}if(c){k=this._test(k,f,b,e)}s=s.replace(t,k===undefined?"???":k)}return this.compact?s.replace(/>\s+</g,"><"):s};Mark.pipes={empty:function(a){return !a||(a+"").trim().length===0?a:false},notempty:function(a){return a&&(a+"").trim().length?a:false},blank:function(b,a){return !!b||b===0?b:a},more:function(d,c){return Mark._size(d)>c?d:false},less:function(d,c){return Mark._size(d)<c?d:false},ormore:function(d,c){return Mark._size(d)>=c?d:false},orless:function(d,c){return Mark._size(d)<=c?d:false},between:function(e,d,f){e=Mark._size(e);return e>=d&&e<=f?e:false},equals:function(d,c){return d==c?d:false},notequals:function(d,c){return d!=c?d:false},like:function(b,a){return new RegExp(a,"i").test(b)?b:false},notlike:function(b,a){return !Mark.pipes.like(b,a)?b:false},upcase:function(a){return String(a).toUpperCase()},downcase:function(a){return String(a).toLowerCase()},capcase:function(a){return a.replace(/(?:^|\s)\S/g,function(b){return b.toUpperCase()})},chop:function(a,b){return a.length>b?a.substr(0,b)+"...":a},tease:function(c,d){var b=c.split(/\s+/);return b.slice(0,d).join(" ")+(b.length>d?"...":"")},trim:function(a){return a.trim()},pack:function(a){return a.trim().replace(/\s{2,}/g," ")},round:function(a){return Math.round(+a)},clean:function(a){return String(a).replace(/<\/?[^>]+>/gi,"")},size:function(a){return a.length},length:function(a){return a.length},reverse:function(a){return[].concat(a).reverse()},join:function(a,b){return a.join(b)},limit:function(b,c,a){return b.slice(+a||0,+c+(+a||0))},split:function(b,a){return b.split(a||",")},choose:function(b,c,a){return !!b?c:(a||"")},toggle:function(c,b,a,d){return a.split(",")[b.match(/\w+/g).indexOf(c+"")]||d},sort:function(a,c){var b=function(e,d){return e[c]>d[c]?1:-1};return[].concat(a).sort(c?b:undefined)},fix:function(a,b){return(+a).toFixed(b)},mod:function(a,b){return(+a)%(+b)},divisible:function(a,b){return a&&(+a%b)===0?a:false},even:function(a){return a&&(+a&1)===0?a:false},odd:function(a){return a&&(+a&1)===1?a:false},number:function(a){return parseFloat(a.replace(/[^\-\d\.]/g,""))},url:function(a){return encodeURI(a)},bool:function(a){return !!a},falsy:function(a){return !a},first:function(a){return a.idx===0},last:function(a){return a.idx===a.size-1},call:function(b,a){return b[a].apply(b,[].slice.call(arguments,2))},set:function(b,a){Mark.globals[a]=b;return""},log:function(a){console.log(a);return a}};if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(typeof module!=="undefined"&&module.exports){module.exports=Mark}else{if(typeof define==="function"&&define.amd){define(function(){return Mark})}};
  Mark.pipes.stringify = function (arr) {
    return JSON.stringify(arr);
  };

  !function(e){"use strict";function t(e,t){if(this.createTextRange){var a=this.createTextRange();a.collapse(!0),a.moveStart("character",e),a.moveEnd("character",t-e),a.select()}else this.setSelectionRange&&(this.focus(),this.setSelectionRange(e,t))}function a(e){var t=this.value.length;if(e="start"==e.toLowerCase()?"Start":"End",document.selection){var a,i,n,l=document.selection.createRange();return a=l.duplicate(),a.expand("textedit"),a.setEndPoint("EndToEnd",l),i=a.text.length-l.text.length,n=i+l.text.length,"Start"==e?i:n}return"undefined"!=typeof this["selection"+e]&&(t=this["selection"+e]),t}var i={codes:{46:127,188:44,109:45,190:46,191:47,192:96,220:92,222:39,221:93,219:91,173:45,187:61,186:59,189:45,110:46},shifts:{96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",39:'"',44:"<",46:">",47:"?"}};e.fn.number=function(n,l,s,r){r="undefined"==typeof r?",":r,s="undefined"==typeof s?".":s,l="undefined"==typeof l?0:l;var u="\\u"+("0000"+s.charCodeAt(0).toString(16)).slice(-4),h=new RegExp("[^"+u+"0-9]","g"),o=new RegExp(u,"g");return n===!0?this.is("input:text")?this.on({"keydown.format":function(n){var u=e(this),h=u.data("numFormat"),o=n.keyCode?n.keyCode:n.which,c="",v=a.apply(this,["start"]),d=a.apply(this,["end"]),p="",f=!1;if(i.codes.hasOwnProperty(o)&&(o=i.codes[o]),!n.shiftKey&&o>=65&&90>=o?o+=32:!n.shiftKey&&o>=69&&105>=o?o-=48:n.shiftKey&&i.shifts.hasOwnProperty(o)&&(c=i.shifts[o]),""==c&&(c=String.fromCharCode(o)),8!=o&&45!=o&&127!=o&&c!=s&&!c.match(/[0-9]/)){var g=n.keyCode?n.keyCode:n.which;if(46==g||8==g||127==g||9==g||27==g||13==g||(65==g||82==g||80==g||83==g||70==g||72==g||66==g||74==g||84==g||90==g||61==g||173==g||48==g)&&(n.ctrlKey||n.metaKey)===!0||(86==g||67==g||88==g)&&(n.ctrlKey||n.metaKey)===!0||g>=35&&39>=g||g>=112&&123>=g)return;return n.preventDefault(),!1}if(0==v&&d==this.value.length?8==o?(v=d=1,this.value="",h.init=l>0?-1:0,h.c=l>0?-(l+1):0,t.apply(this,[0,0])):c==s?(v=d=1,this.value="0"+s+new Array(l+1).join("0"),h.init=l>0?1:0,h.c=l>0?-(l+1):0):45==o?(v=d=2,this.value="-0"+s+new Array(l+1).join("0"),h.init=l>0?1:0,h.c=l>0?-(l+1):0,t.apply(this,[2,2])):(h.init=l>0?-1:0,h.c=l>0?-l:0):h.c=d-this.value.length,h.isPartialSelection=v==d?!1:!0,l>0&&c==s&&v==this.value.length-l-1)h.c++,h.init=Math.max(0,h.init),n.preventDefault(),f=this.value.length+h.c;else if(45!=o||0==v&&0!=this.value.indexOf("-"))if(c==s)h.init=Math.max(0,h.init),n.preventDefault();else if(l>0&&127==o&&v==this.value.length-l-1)n.preventDefault();else if(l>0&&8==o&&v==this.value.length-l)n.preventDefault(),h.c--,f=this.value.length+h.c;else if(l>0&&127==o&&v>this.value.length-l-1){if(""===this.value)return;"0"!=this.value.slice(v,v+1)&&(p=this.value.slice(0,v)+"0"+this.value.slice(v+1),u.val(p)),n.preventDefault(),f=this.value.length+h.c}else if(l>0&&8==o&&v>this.value.length-l){if(""===this.value)return;"0"!=this.value.slice(v-1,v)&&(p=this.value.slice(0,v-1)+"0"+this.value.slice(v),u.val(p)),n.preventDefault(),h.c--,f=this.value.length+h.c}else 127==o&&this.value.slice(v,v+1)==r?n.preventDefault():8==o&&this.value.slice(v-1,v)==r?(n.preventDefault(),h.c--,f=this.value.length+h.c):l>0&&v==d&&this.value.length>l+1&&v>this.value.length-l-1&&isFinite(+c)&&!n.metaKey&&!n.ctrlKey&&!n.altKey&&1===c.length&&(p=d===this.value.length?this.value.slice(0,v-1):this.value.slice(0,v)+this.value.slice(v+1),this.value=p,f=v);else n.preventDefault();f!==!1&&t.apply(this,[f,f]),u.data("numFormat",h)},"keyup.format":function(i){var n,s=e(this),r=s.data("numFormat"),u=i.keyCode?i.keyCode:i.which,h=a.apply(this,["start"]),o=a.apply(this,["end"]);0!==h||0!==o||189!==u&&109!==u||(s.val("-"+s.val()),h=1,r.c=1-this.value.length,r.init=1,s.data("numFormat",r),n=this.value.length+r.c,t.apply(this,[n,n])),""===this.value||(48>u||u>57)&&(96>u||u>105)&&8!==u&&46!==u&&110!==u||(s.val(s.val()),l>0&&(r.init<1?(h=this.value.length-l-(r.init<0?1:0),r.c=h-this.value.length,r.init=1,s.data("numFormat",r)):h>this.value.length-l&&8!=u&&(r.c++,s.data("numFormat",r))),46!=u||r.isPartialSelection||(r.c++,s.data("numFormat",r)),n=this.value.length+r.c,t.apply(this,[n,n]))},"paste.format":function(t){var a=e(this),i=t.originalEvent,n=null;return window.clipboardData&&window.clipboardData.getData?n=window.clipboardData.getData("Text"):i.clipboardData&&i.clipboardData.getData&&(n=i.clipboardData.getData("text/plain")),a.val(n),t.preventDefault(),!1}}).each(function(){var t=e(this).data("numFormat",{c:-(l+1),decimals:l,thousands_sep:r,dec_point:s,regex_dec_num:h,regex_dec:o,init:this.value.indexOf(".")?!0:!1});""!==this.value&&t.val(t.val())}):this.each(function(){var t=e(this),a=+t.text().replace(h,"").replace(o,".");t.number(isFinite(a)?+a:0,l,s,r)}):this.text(e.number.apply(window,arguments))};var n=null,l=null;e.isPlainObject(e.valHooks.text)?(e.isFunction(e.valHooks.text.get)&&(n=e.valHooks.text.get),e.isFunction(e.valHooks.text.set)&&(l=e.valHooks.text.set)):e.valHooks.text={},e.valHooks.text.get=function(t){var a,i=e(t),l=i.data("numFormat");return l?""===t.value?"":(a=+t.value.replace(l.regex_dec_num,"").replace(l.regex_dec,"."),(0===t.value.indexOf("-")?"-":"")+(isFinite(a)?a:0)):e.isFunction(n)?n(t):void 0},e.valHooks.text.set=function(t,a){var i=e(t),n=i.data("numFormat");if(n){var s=e.number(a,n.decimals,n.dec_point,n.thousands_sep);return e.isFunction(l)?l(t,s):t.value=s}return e.isFunction(l)?l(t,a):void 0},e.number=function(e,t,a,i){i="undefined"==typeof i?"1000"!==new Number(1e3).toLocaleString()?new Number(1e3).toLocaleString().charAt(1):"":i,a="undefined"==typeof a?new Number(.1).toLocaleString().charAt(1):a,t=isFinite(+t)?Math.abs(t):0;var n="\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4),l="\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4);e=(e+"").replace(".",a).replace(new RegExp(l,"g"),"").replace(new RegExp(n,"g"),".").replace(new RegExp("[^0-9+-Ee.]","g"),"");var s=isFinite(+e)?+e:0,r="",u=function(e,t){return""+ +(Math.round((""+e).indexOf("e")>0?e:e+"e+"+t)+"e-"+t)};return r=(t?u(s,t):""+Math.round(s)).split("."),r[0].length>3&&(r[0]=r[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(r[1]||"").length<t&&(r[1]=r[1]||"",r[1]+=new Array(t-r[1].length+1).join("0")),r.join(a)}}(jQuery);

  /*
   *  jquery-maskmoney - v3.0.2
  */
  !function($){"use strict";$.browser||($.browser={},$.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),$.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),$.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),$.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()));var a={destroy:function(){return $(this).unbind(".maskMoney"),$.browser.msie&&(this.onpaste=null),this},mask:function(a){return this.each(function(){var b,c=$(this);return"number"==typeof a&&(c.trigger("mask"),b=$(c.val().split(/\D/)).last()[0].length,a=a.toFixed(b),c.val(a)),c.trigger("mask")})},unmasked:function(){return this.map(function(){var a,b=$(this).val()||"0",c=-1!==b.indexOf("-");return $(b.split(/\D/).reverse()).each(function(b,c){return c?(a=c,!1):void 0}),b=b.replace(/\D/g,""),b=b.replace(new RegExp(a+"$"),"."+a),c&&(b="-"+b),parseFloat(b)})},init:function(a){return a=$.extend({prefix:"",suffix:"",affixesStay:!0,thousands:",",decimal:".",precision:2,allowZero:!1,allowNegative:!1},a),this.each(function(){function b(){var a,b,c,d,e,f=s.get(0),g=0,h=0;return"number"==typeof f.selectionStart&&"number"==typeof f.selectionEnd?(g=f.selectionStart,h=f.selectionEnd):(b=document.selection.createRange(),b&&b.parentElement()===f&&(d=f.value.length,a=f.value.replace(/\r\n/g,"\n"),c=f.createTextRange(),c.moveToBookmark(b.getBookmark()),e=f.createTextRange(),e.collapse(!1),c.compareEndPoints("StartToEnd",e)>-1?g=h=d:(g=-c.moveStart("character",-d),g+=a.slice(0,g).split("\n").length-1,c.compareEndPoints("EndToEnd",e)>-1?h=d:(h=-c.moveEnd("character",-d),h+=a.slice(0,h).split("\n").length-1)))),{start:g,end:h}}function c(){var a=!(s.val().length>=s.attr("maxlength")&&s.attr("maxlength")>=0),c=b(),d=c.start,e=c.end,f=c.start!==c.end&&s.val().substring(d,e).match(/\d/)?!0:!1,g="0"===s.val().substring(0,1);return a||f||g}function d(a){s.each(function(b,c){if(c.setSelectionRange)c.focus(),c.setSelectionRange(a,a);else if(c.createTextRange){var d=c.createTextRange();d.collapse(!0),d.moveEnd("character",a),d.moveStart("character",a),d.select()}})}function e(b){var c="";return b.indexOf("-")>-1&&(b=b.replace("-",""),c="-"),c+a.prefix+b+a.suffix}function f(b){var c,d,f,g=b.indexOf("-")>-1&&a.allowNegative?"-":"",h=b.replace(/[^0-9]/g,""),i=h.slice(0,h.length-a.precision);return i=i.replace(/^0*/g,""),i=i.replace(/\B(?=(\d{3})+(?!\d))/g,a.thousands),""===i&&(i="0"),c=g+i,a.precision>0&&(d=h.slice(h.length-a.precision),f=new Array(a.precision+1-d.length).join(0),c+=a.decimal+f+d),e(c)}function g(a){var b,c=s.val().length;s.val(f(s.val())),b=s.val().length,a-=c-b,d(a)}function h(){var a=s.val();s.val(f(a))}function i(){var b=s.val();return a.allowNegative?""!==b&&"-"===b.charAt(0)?b.replace("-",""):"-"+b:b}function j(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function k(a){a=a||window.event;var d,e,f,h,k,l=a.which||a.charCode||a.keyCode;return void 0===l?!1:48>l||l>57?45===l?(s.val(i()),!1):43===l?(s.val(s.val().replace("-","")),!1):13===l||9===l?!0:!$.browser.mozilla||37!==l&&39!==l||0!==a.charCode?(j(a),!0):!0:c()?(j(a),d=String.fromCharCode(l),e=b(),f=e.start,h=e.end,k=s.val(),s.val(k.substring(0,f)+d+k.substring(h,k.length)),g(f+1),!1):!1}function l(c){c=c||window.event;var d,e,f,h,i,k=c.which||c.charCode||c.keyCode;return void 0===k?!1:(d=b(),e=d.start,f=d.end,8===k||46===k||63272===k?(j(c),h=s.val(),e===f&&(8===k?""===a.suffix?e-=1:(i=h.split("").reverse().join("").search(/\d/),e=h.length-i-1,f=e+1):f+=1),s.val(h.substring(0,e)+h.substring(f,h.length)),g(e),!1):9===k?!0:!0)}function m(){r=s.val(),h();var a,b=s.get(0);b.createTextRange&&(a=b.createTextRange(),a.collapse(!1),a.select())}function n(){setTimeout(function(){h()},0)}function o(){var b=parseFloat("0")/Math.pow(10,a.precision);return b.toFixed(a.precision).replace(new RegExp("\\.","g"),a.decimal)}function p(b){if($.browser.msie&&k(b),""===s.val()||s.val()===e(o()))a.allowZero?a.affixesStay?s.val(e(o())):s.val(o()):s.val("");else if(!a.affixesStay){var c=s.val().replace(a.prefix,"").replace(a.suffix,"");s.val(c)}s.val()!==r&&s.change()}function q(){var a,b=s.get(0);b.setSelectionRange?(a=s.val().length,b.setSelectionRange(a,a)):s.val(s.val())}var r,s=$(this);a=$.extend(a,s.data()),s.unbind(".maskMoney"),s.bind("keypress.maskMoney",k),s.bind("keydown.maskMoney",l),s.bind("blur.maskMoney",p),s.bind("focus.maskMoney",m),s.bind("click.maskMoney",q),s.bind("cut.maskMoney",n),s.bind("paste.maskMoney",n),s.bind("mask.maskMoney",h)})}};$.fn.maskMoney=function(b){return a[b]?a[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?($.error("Method "+b+" does not exist on jQuery.maskMoney"),void 0):a.init.apply(this,arguments)}}(window.jQuery||window.Zepto);

  (function( $ ) {
    'use strict';

    Mark.pipes.number_format = function (num) {
      return $.number(num);
    };
    Mark.pipes.in_usd = function (num) {
      return $.number(num);
    };

    var SHIT = {
      RATIO: 22000,
      MIN_SALARY: 1150000,
      AREA_MIN_SALARY: 3100000,
      SOCIAL: 8,
      HEALTH: 1.5,
      UNEMPLOY: 1,
      EMPLOYER_SOCIAL: 18,
      EMPLOYER_HEALTH: 3,
      EMPLOYER_UNEMPLOY: 1,
      PERSONAL_REDUCE: 9000000,
      DEPENDANT_REDUCE: 3600000,
      vnd: 10000000,
      usd: 0,
      dependants: 0,
      grossSalary: 0,
      netSalary: 0,
      socialInsurance: 0,
      healthInsurance: 0,
      unemployInsurance: 0,
      noTaxSalary: 0,
      dependantReduce: 0,
      taxSalary: 0,
      tax1: 0,
      tax2: 0,
      tax3: 0,
      tax4: 0,
      tax5: 0,
      tax6: 0,
      tax7: 0,
      totalTax: 0,
      employerSocialInsurance: 0,
      employerHealthInsurance: 0,
      employerUnemployInsurance: 0,
      employerTotal: 0,
      init: function() {
        var _this = this;

        _this.vnd = parseInt($('#vnd').val().replace(/,/g, ''));
        _this.usd = parseFloat($('#usd').val().replace(/,/g, ''));
        _this.RATIO = parseInt($('#RATIO').val().replace(/,/g, ''));
        _this.MIN_SALARY = parseInt($('#MIN_SALARY').val().replace(/,/g, ''));
        _this.SOCIAL = parseFloat($('#social').val().replace(/,/g, ''));
        _this.HEALTH = parseFloat($('#health').val().replace(/,/g, ''));
        _this.UNEMPLOY = parseFloat($('#unem').val().replace(/,/g, ''));
        _this.PERSONAL_REDUCE = parseInt($('#PERSONAL_REDUCE').val().replace(/,/g, ''));
        _this.DEPENDANT_REDUCE = parseInt($('#DEPENDANT_REDUCE').val().replace(/,/g, ''));
        _this.dependants = parseInt($('#depNum').val().replace(/,/g, ''));

        $('#vnd, #RATIO, #MIN_SALARY, #PERSONAL_REDUCE, #DEPENDANT_REDUCE, #depNum')
          .maskMoney({
            allowZero: true,
            precision: 0
          });

        $('#usd, #social, #health, #unem')
          .maskMoney({
            allowZero: true,
            precision: 1
          });

        $('#usd, #social, #health, #unem')
          .on('click', function(e) {
            $(this).select();
          });

        $('#vnd, #RATIO, #MIN_SALARY, #PERSONAL_REDUCE, #DEPENDANT_REDUCE, #depNum')
          .on('click', function(e) {
            $(this).select();
          });


        $('#btn1').on('click', function(e) {
          _this.grossToNet();
          _this.render();
        });

        $('#btn2').on('click', function(e) {
          _this.netToGross();
          _this.render();
        });

      },
      grossToNet: function() {
        var _this = this;

        _this.grossSalary       = _this.vnd + (_this.usd * _this.RATIO);
        _this.socialInsurance   = _this.min(_this.grossSalary, _this.MIN_SALARY * 20) * _this.SOCIAL / 100;
        _this.healthInsurance   = _this.min(_this.grossSalary, _this.MIN_SALARY * 20) * _this.HEALTH / 100;
        _this.unemployInsurance = _this.min(_this.grossSalary, _this.AREA_MIN_SALARY * 20) * _this.UNEMPLOY / 100;

        _this.noTaxSalary     = _this.grossSalary - _this.socialInsurance - _this.healthInsurance - _this.unemployInsurance;
        _this.dependantReduce = _this.DEPENDANT_REDUCE * _this.dependants;
        _this.taxSalary       = _this.max(0, _this.noTaxSalary - _this.PERSONAL_REDUCE - _this.dependantReduce);

        _this.tax1 = _this.bound(_this.taxSalary, 0, 5000000) * 5 / 100;
        _this.tax2 = _this.bound(_this.taxSalary, 5000000, 10000000) * 10 / 100;
        _this.tax3 = _this.bound(_this.taxSalary, 10000000, 18000000) * 15 / 100;
        _this.tax4 = _this.bound(_this.taxSalary, 18000000, 32000000) * 20 / 100;
        _this.tax5 = _this.bound(_this.taxSalary, 32000000, 52000000) * 25 / 100;
        _this.tax6 = _this.bound(_this.taxSalary, 52000000, 80000000) * 30 / 100;
        _this.tax7 = _this.bound(_this.taxSalary, 80000000, 9999999999) * 35 / 100;

        _this.totalTax  = _this.tax1 + _this.tax2 + _this.tax3 + _this.tax4 + _this.tax5 + _this.tax6 + _this.tax7;
        _this.netSalary = _this.noTaxSalary - _this.totalTax;

        _this.employerSocialInsurance   = _this.min(_this.grossSalary, _this.MIN_SALARY * 20) * _this.EMPLOYER_SOCIAL / 100;
        _this.employerHealthInsurance   = _this.min(_this.grossSalary, _this.MIN_SALARY * 20) * _this.EMPLOYER_HEALTH / 100;
        _this.employerUnemployInsurance = _this.min(_this.grossSalary, _this.AREA_MIN_SALARY * 20) * _this.EMPLOYER_UNEMPLOY / 100;
        _this.employerTotal             = _this.grossSalary + _this.employerSocialInsurance + _this.employerHealthInsurance + _this.employerUnemployInsurance;
      },
      netToGross: function() {
        var _this = this;

        _this.netSalary   = 0;
        _this.oldVnd      = _this.vnd;
        _this.totalSalary = _this.oldVnd + (_this.usd * _this.RATIO);

        while (_this.netSalary < _this.totalSalary) {
          _this.vnd += 5;
          _this.grossToNet();
        };
        _this.vnd = _this.oldVnd;
      },
      render: function() {
        var _this = this;
        $(Mark.up( $("#tpl").html(), {
          _: _this
        })).appendTo($('#result').html(''));
      },
      min: function(first, second) {
        if (first < second) {
            return first;
        }
        return second;
      },
      max: function(first, second) {
        if (first > second) {
            return first;
        }
        return second;
      },
      bound: function(value, minimum, maximum) {
        if (value >= maximum) {
            return maximum - minimum;
        } else if (value <= minimum) {
            return 0;
        } else {
            return value - minimum;
        }
      }
    };

    $(function() {
      SHIT.init();
      SHIT.grossToNet();
      SHIT.render();
    });

  })(jQuery);

  </script>
</body>
</html>
